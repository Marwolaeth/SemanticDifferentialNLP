# Гибкие методы семантического анализа с трансформерными моделями для репутационных исследований: опыт применения

## 1. Задача проекта

**Имидж** — это восприятие объекта (например, бренда, в т. ч. личного) в сознании аудитории, включающее ассоциации, эмоции и оценки. **Семантический дифференциал** — это метод, позволяющий измерять имидж через набор противоположных характеристик (например, "доброжелательный - недоброжелательный"). 

Основная цель проекта — оценка имиджа объектов с использованием семантико-дифференциальных шкал, что позволяет получить количественные данные о восприятии и проводить более глубокий анализ.

### Пример: Корпорация в сфере технологий (все данные изменены, суть сохранена)

**Контекст**: Представьте, что крупная корпорация в сфере технологий решила обновить свой имидж для интернет-аудитории. Они хотят позиционировать себя как надежный партнер, который заботится о безопасности и конфиденциальности пользователей, а не просто как коммерческая организация.

#### Задачи
1. **Позиционирование**: Корпорация стремится ассоциироваться с заботой о пользователях и их данных, подчеркивая свою роль в защите их информации.
2. **Избежание негативного имиджа**: Они хотят избежать восприятия как слишком агрессивного игрока на рынке, который лишь стремится к максимизации прибыли. Вместо этого они хотят акцентировать внимание на своей ответственности и этичности.
3. **Снижение негативных маркеров**: В прошлом корпорация сталкивалась с обвинениями в недостаточной прозрачности, недостаточной заботе о клиентах и низкой компетентности разработчиков. Эти негативные ассоциации время от времени всплывали в новостях, особенно в контексте инцидентов с утечками данных, и в сообщениях пользователей социальных медиа.

#### Подход
- **Анализ общественного мнения**: Корпорация проводит анализ общественного мнения и использует семантический дифференциал для выявления текущих ассоциаций с брендом. Здесь может пригодиться семантический анализ с трансформерными моделями, который позволяет глубже понять настроения пользователей и выявить ключевые темы, связанные с репутацией компании.
  
- **Коммуникационная стратегия**: На основе полученных данных разрабатывается коммуникационная стратегия, направленная на изменение восприятия. Включает в себя кампании по повышению осведомленности о мерах безопасности, проводимых компанией, и о том, как они заботятся о своих клиентах. Используя результаты семантического анализа, корпорация может адаптировать свои сообщения, ***акцентируя внимание на тех аспектах, которые наиболее важны для аудитории***.

- **Мониторинг имиджа**: Постоянный мониторинг общественного мнения позволяет корректировать стратегии в зависимости от изменений в восприятии. Такой проект может помочь в автоматизации этого процесса, позволяя компании быстро реагировать на негативные упоминания и адаптировать свои действия в реальном времени.

## 2. Требования

валидность и надежность, в том числе:

- **Конвергентная концептуальная валидность**: Это степень, в которой разные методы измерения одного и того же концепта дают схожие результаты. Она должна проявляться в том, что результаты одного и того же метода и модели при оценке различных текстов, в которых одинаково выражены те или иные признаки, должны быть согласованы и показывать высокую корреляцию.

- **Дивергентная концептуальная валидность**: Это степень, в которой измерения, предназначенные для оценки разных концептов, действительно различаются. Она должна проявляться в том, что оценки, полученные для разных семантических шкал, не должны быть слишком схожи, что подтверждает, что мы измеряем именно то, что задумали.

## 3. Методы

- нулевая классификация (как советует учебник HuggingFace)
- близость векторных представлений (применяется в психометрии)
- оценка инструктированной модели (подход, при котором чат-модель получает четкие инструкции для выполнения задачи)

## 4. Реализация:

Анонимизация объекта: изначально для удобства извлечения векторного представления именно исследуемого объекта, но оказалось, что так лучше работает и нулевая классификация, а также нормально понимают чат-модели

Нулевая классификация: конкурирующие гипотезы:

- положительный признак, отрицательный и нейтральный (иначе сдвиг в сторону положительного)
- производительность: каждая тройка гипотез проверяется отдельно, включая токенизацию

Близость векторных представлений: разные модели для качественных эмбеддингов

- близость текстов к словам, представляющим концепты, уже применяется в психометрии (Kjell et al.)
- разные методы векторизации текста: CLS, среднее, токен объекта
- метрики: косинусная близость, корреляция Спирмена
- производительность: после однократной векторизации концептов оценка происходит почти моментально

Оценка чат-моделями с инструктированием:

- не было возможности протестировать очень большие модели, токены не использовал принципиально
- напоминает работу с кодировщиками в контент-анализе
- все зависит от хорошо сформулированного запроса
- в запросе специально обговариваем требование дивергентной валидности и ограничиваем фантазию
- задание вернуть JSON работает лучше, чем просто оценка
- JSON не всегда валидный, но мы получаем результаты грубым парсингом
- ужасная производительность: без графического ускорителя работает медленнее, чем человек!

Интерфейс: площадка для экспериментов:

- ввод произвольного текста или случайного из специально подобранных примеров
- настройка семантических шкал с возможностью импорта и экспорта
- выбор модели
- настройки гиперпараметров (не в смысле машинного обучения): формулировка гипотезы, обработка текста, инструкции для чат-моделей.
- возможность выгрузить историю оцененных текстов для дальнейшего анализа и/или разметки

## 5. Результаты
Нулевая классификация:

- хорошая конвергентная валидность: большинство моделей неплохо справляются
- так себе дивергентная валидность
- некоторые модели хуже понимают отрицание, многие не могут определить, кому именно атрибутировать признак: исследуемому объекту или, например, конкурентам, которые упоминаются рядом
- высокая надежность (разные модели для одного и того же текста или одна и та же модель для похожих текстов)

Близость векторных представлений:

- слабая конвергентная валидность (очень слабо различаются оценки для текстов с выраженной и невыраженной семантикой)
- практически нулевая дивергентная валидность (скоры для разных семантических шкал слабо, но коррелированы)
- наверное, хорошо для классификации, если использовать `argmax`, но не для оценки рейтинга

Инструктирование чат-моделей:

- разные модели показывают разное качество
- модели для креатив (Llama) хуже, чем размышляющие (reasoning) модели (DeepSeek)
- чемпион — Phi4! DeepSeek 14b немного уступает, с меньшей надежностью и отдельнымии спорными решениями
- а еще Phi4 быстрее, чем DeepSeek 14b
- и вообще, Phi4 — как Mercedes: не хочется возвращаться к чему-то другому
- высокая конвергентная и дивергентная валидность, особенно у Phi: с остальными часто можно поспорить
- низкая надежность (разные модели имеют разное мнение, Llama3.2 имеет разное мнение всегда, как сумасшедший шляпник)
- высокая надежность для одной и той же модели (только Phi4) для похожих текстов (парафразов)

## Выводы

Если нужно экономно и быстро — использовать модели-кодировщики, предобученные на задачи NLI. Лучше всего — дообучить еще, не просто на выводы, а на интерпретативные выводы.

Если нужно качественно — использовать Phi4 или более продвинутые модели. DeepSeek размышляет и отвечает по-английски — возможно, он лучше справится с англоязычными текстами. 
